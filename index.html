<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generative System Laboratory [Full Implementation]</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@300;400&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">

    <!-- CSS -->
    <link rel="stylesheet" href="style.css">

    <!-- Font Awesome for icons (Optional) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

</head>
<body>
    <div class="lab-container">

        <!-- Control Sidebar -->
        <aside class="control-panel">
            <header class="panel-header">
                 <h1 class="lab-title"><i class="fas fa-flask-vial"></i> GenSys Lab</h1>
            </header>

            <section class="control-section system-selector">
                <label for="system-type">Select System:</label>
                <select id="system-type">
                    <option value="ca_life">Cellular Automaton (Life)</option>
                    <option value="ca_brain">Cellular Automaton (Brain)</option> <!-- NEW -->
                    <option value="l_system_tree">L-System (Tree)</option>
                    <option value="l_system_koch">L-System (Koch Curve)</option> <!-- NEW -->
                    <option value="agent_slime">Agent System (Slime Mold)</option> <!-- NEW -->
                </select>
            </section>

            <section class="control-section sim-controls">
                <h3>Simulation Control</h3>
                <div class="button-group">
                    <button id="play-pause-button"><i class="fas fa-play"></i></button>
                    <button id="step-button"><i class="fas fa-forward"></i></button>
                    <button id="reset-button"><i class="fas fa-undo"></i></button>
                </div>
                <label for="speed-slider">Speed:</label>
                <input type="range" id="speed-slider" min="1" max="60" value="10" step="1">
                <span id="speed-value">10 fps</span>
            </section>

             <section id="parameter-controls" class="control-section parameter-controls">
                 <!-- (Dynamic Parameters structure remains the same) -->
                <h3>Parameters (<span id="current-system-name">System</span>)</h3>
                 <div id="dynamic-params"><p>Loading parameters...</p></div>
            </section>

            <section class="control-section viz-controls">
                <!-- (Visualization Controls remain the same) -->
                 <h3>Visualization</h3>
                 <div class="viz-option">... Palette ...</div>
                 <div class="viz-option">... Grid Toggle ...</div>
                 <div class="viz-option" id="extra-viz-options">
                     <!-- Extra Viz controls added by specific systems if needed -->
                 </div>
             </section>

            <section class="control-section info-display">
                <!-- (Info Display structure remains the same) -->
                 <h3>System Info</h3>
                 <div id="simulation-info">... Iteration, Population ...</div>
            </section>

            <footer class="panel-footer">
                <p>Â© 2023 Algorithmic Exploration</p>
            </footer>
        </aside>

        <!-- Main Simulation Area -->
        <main class="simulation-area">
            <canvas id="simulation-canvas"></canvas>
            <div class="interaction-hint" id="interaction-hint">Interaction Mode: Ready</div>
         </main>

    </div> <!-- End Lab Container -->

    <!-- Core Lab Logic (Type="module" is CRITICAL) -->
    <script src="lab.js" defer type="module"></script>

</body>
</html>